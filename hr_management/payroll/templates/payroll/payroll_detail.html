{% extends 'base.html' %}

{% block title %}Chi tiết bảng lương{% endblock %}

{% block content %}
<div class="container mt-4">
    <h1 class="mb-4">Chi tiết bảng lương</h1>

    <div class="card mb-4">
        <div class="card-header">
            <h5 class="mb-0">Thông tin bảng lương</h5>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-6">
                    <p><strong>Tên bảng lương:</strong> {{ payroll.name }}</p>
                    <p><strong>Tháng/Năm:</strong> {{ payroll.month }}/{{ payroll.year }}</p>
                    <p><strong>Mẫu bảng lương:</strong> {{ payroll.template.name|default:"Không có" }}</p>
                </div>
                <div class="col-md-6">
                    <p><strong>Bảng chấm công:</strong> {{ payroll.attendance_sheet.name|default:"Không có" }}</p>
                    <p><strong>Trạng thái:</strong>
                        {% if payroll.status == 'draft' %}
                        <span class="badge bg-secondary">Bản nháp</span>
                        {% elif payroll.status == 'pending' %}
                        <span class="badge bg-warning">Chờ duyệt</span>
                        {% elif payroll.status == 'approved' %}
                        <span class="badge bg-success">Đã duyệt</span>
                        {% elif payroll.status == 'paid' %}
                        <span class="badge bg-primary">Đã thanh toán</span>
                        {% elif payroll.status == 'partially_paid' %}
                        <span class="badge bg-info">Đã thanh toán một phần</span>
                        {% endif %}
                    </p>
                    <p><strong>Ngày tạo:</strong> {{ payroll.created_at }}</p>
                </div>
            </div>

            <div class="mt-3">
                {% if payroll.status == 'draft' %}
                <a href="{% url 'calculate_payroll' pk=payroll.pk %}" class="btn btn-primary">Tính lương</a>
                {% elif payroll.status == 'pending' %}
                <form method="post" action="{% url 'approve_payroll' pk=payroll.pk %}" class="d-inline">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-success">Phê duyệt</button>
                </form>
                {% elif payroll.status == 'approved' %}
                <a href="{% url 'salary_payment_create' payroll_id=payroll.pk %}" class="btn btn-primary">Tạo đợt chi trả</a>
                {% endif %}
                <a href="{% url 'payroll_list' %}" class="btn btn-secondary">Quay lại</a>

